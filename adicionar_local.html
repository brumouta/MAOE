<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Adicionar Local</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, min-zoom=1, max-zoom=1, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/gaia/headers.css">
    <!-- <link rel="stylesheet" type="text/css" href="css/gaia/buttons.css"> -->
    <link rel="stylesheet" type="text/css" href="css/gaia/buttons.css">
    <link rel="stylesheet" type="text/css" href="css/gaia/input_areas.css">
    <link rel="stylesheet" type="text/css" href="css/gaia/action_menu.css">
    <link rel="stylesheet" type="text/css" href="css/gaia/switches.css">
</head>
<body>

<section role="region">
    <header>
        <button><span class="icon icon-back">back</span></button>
        <h1>Maoe</h1>
    </header>

    <header>
    <h2 class="p1">Primeiro passo</h2>
    <h2 class="p2" style="display:none;">Segundo passo</h2>
    <h2 class="p3" style="display:none;">Terceiro passo</h2>
    </header>
</section>

<div style="padding:0 15px;">
    <div id="passo-1">
        <p>Escolha o local que deseja registrar</p>
        <button name="example" value="1" class="button_tp_loc">Barraca</button>
        <button name="example" value="2" class="button_tp_loc">Arena</button>
    </div>

    <div id="passo-2" style="display:none;">
    	<h1>Segundo Passo</h1>

    	<p>Agora caminhe até <span id="tipo_local"></span>, assim você pode tirar uma foto dela e saberemos melhor onde ela fica.</p>
    	<button id="cheguei">Já estou no lugar certo</button>
    </div>

    <div id="passo-3" style="display:none;">
    	<h1>Terceiro Passo</h1>

    	<p>Agora é enviar a foto</p>
    	<div id="image-presenter" style="max-width:460px;">Toque aqui para escolher uma foto</div>
    	<button id="enviar">Enviar</button>
    </div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script>
document.querySelector('.icon-back').onclick = function () { window.history.back() }
</script>
<script>
var data = {};

function pickImage () {
	var pickImage = document.querySelector("#image-presenter");
    if (pickImage) { 
        pickImage.onclick = function () {
             var pick = new MozActivity({
                 name: "pick",
                 data: {
                     type: ["image/png", "image/jpg", "image/jpeg"]
				}
             });

            pick.onsuccess = function () {
                var img = document.createElement("img");
                img.src = window.URL.createObjectURL(this.result.blob);
                var imagePresenter = document.querySelector("#image-presenter");
                imagePresenter.appendChild(img);
                imagePresenter.style.display = "block";
            };
        }
    }
}

function step1(evt) {
	data.tipo_local = evt.target.options[evt.target.selectedIndex].value;
	document.querySelector('#passo-1').style.display = "none";
	document.querySelector('#passo-2').style.display = "block";
    $('h2').hide();
    $('h2.p2').show();
}

function step2(evt) {
	navigator.geolocation.getCurrentPosition(function(position) {
		data.lat = position.coords.latitude;
		data.lng = position.coords.longitude;
		document.querySelector('#passo-2').style.diisplay = "none";
		document.querySelector('#passo-3').style.diisplay = "block";
	});
}

function step3 (evt) {
     var pick = new MozActivity({
         name: "pick",
         data:{
         	type:["image/png", "image/jpg", "image/jpeg"]
         }
     });

    pick.onsuccess = function () {
        var img = document.createElement("img");
        img.src = window.URL.createObjectURL(this.result.blob);
        document.querySelector("#image-presenter").appendChild(img);
    };

    pick.onerror = function () {
        //console.log("An error occurred");
    };
}

//document.querySelector("#local").addEventListener('change',step1);
document.querySelector("#cheguei").addEventListener('click',step2);
document.querySelector("#image-presenter").addEventListener('click',step3);
</script>
</body>
</html>